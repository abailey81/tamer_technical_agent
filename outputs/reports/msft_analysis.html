<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MSFT Technical Analysis Report</title>
    <style>
        :root {
            --bg-0: #0a0a0f;
            --bg-1: #111118;
            --bg-2: #1a1a24;
            --bg-3: #252532;
            --border: #2d2d3a;
            --text-1: #f4f4f6;
            --text-2: #a1a1aa;
            --text-3: #71717a;
            --green: #10b981;
            --red: #ef4444;
            --yellow: #fbbf24;
        }
        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-0);
            color: var(--text-1);
            line-height: 1.5;
            font-size: 14px;
        }
        .container { max-width: 1400px; margin: 0 auto; padding: 32px; }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 32px;
            background: linear-gradient(135deg, var(--bg-1), var(--bg-2));
            border: 1px solid var(--border);
            border-radius: 16px;
            margin-bottom: 24px;
        }
        .header-left h1 { font-size: 36px; font-weight: 700; margin-bottom: 4px; }
        .header-left .company { font-size: 18px; color: var(--text-2); margin-bottom: 16px; }
        .header-meta { display: flex; gap: 24px; font-size: 13px; color: var(--text-3); }
        .quality-badge {
            display: inline-block;
            padding: 8px 16px;
            background: #10b98122;
            color: #10b981;
            border-radius: 8px;
            font-weight: 600;
        }
        .signal-hero {
            display: grid;
            grid-template-columns: 1fr auto auto;
            gap: 32px;
            padding: 32px;
            background: var(--bg-1);
            border: 1px solid var(--border);
            border-radius: 16px;
            margin-bottom: 24px;
            align-items: center;
        }
        .signal-content .label { font-size: 12px; text-transform: uppercase; letter-spacing: 1px; color: var(--text-3); }
        .signal-content .value { font-size: 56px; font-weight: 800; color: #f87171; line-height: 1.1; }
        .signal-content .strength { 
            display: inline-block;
            margin-top: 12px;
            padding: 8px 16px;
            background: var(--bg-2);
            border-radius: 8px;
            font-size: 14px;
            color: var(--text-2);
        }
        .gauge { width: 140px; height: 140px; }
        .gauge-value { font-size: 24px; font-weight: 700; fill: var(--text-1); text-anchor: middle; }
        .gauge-label { font-size: 11px; fill: var(--text-3); text-anchor: middle; }
        .recommendation {
            grid-column: 1 / -1;
            padding: 20px 24px;
            background: var(--bg-2);
            border-radius: 12px;
            margin-top: 8px;
        }
        .recommendation .rec-label { font-size: 11px; text-transform: uppercase; letter-spacing: 1px; color: var(--text-3); margin-bottom: 8px; }
        .recommendation .rec-text { font-size: 15px; line-height: 1.6; }
        .grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 24px; margin-bottom: 24px; }
        .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; }
        .section {
            background: var(--bg-1);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
        }
        .section-title {
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-2);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
        }
        .metric {
            background: var(--bg-2);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }
        .metric .value { font-size: 28px; font-weight: 700; margin-bottom: 4px; }
        .metric .value.positive { color: var(--green); }
        .metric .value.negative { color: var(--red); }
        .metric .label { font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; color: var(--text-3); }
        .family-card {
            background: var(--bg-1);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
        }
        .family-header { display: flex; align-items: center; gap: 16px; margin-bottom: 16px; }
        .family-badge { padding: 6px 14px; border-radius: 6px; font-size: 12px; font-weight: 600; color: white; }
        .family-meta { flex: 1; }
        .family-name { font-weight: 600; font-size: 13px; }
        .family-conf { font-size: 12px; color: var(--text-3); display: block; }
        .family-weight { font-size: 13px; color: var(--text-3); }
        .indicator-row {
            display: grid;
            grid-template-columns: 90px 100px 70px 100px 1fr;
            gap: 12px;
            padding: 10px 12px;
            background: var(--bg-2);
            border-radius: 8px;
            font-size: 13px;
            margin-bottom: 6px;
            align-items: center;
        }
        .ind-name { font-weight: 500; }
        .ind-signal { font-weight: 600; }
        .ind-conf { color: var(--text-2); }
        .ind-zone { color: var(--text-3); font-size: 12px; }
        .ind-factors { color: var(--text-3); font-size: 11px; }
        .divergence-item {
            display: grid;
            grid-template-columns: 140px 80px 80px 80px;
            gap: 16px;
            padding: 14px 16px;
            background: var(--bg-2);
            border-radius: 8px;
            border-left: 3px solid;
            margin-bottom: 8px;
            font-size: 13px;
        }
        .div-type { font-weight: 600; }
        .div-ind { color: var(--text-2); }
        .div-strength, .div-duration { color: var(--text-3); }
        .level-item { display: flex; justify-content: space-between; padding: 12px 16px; background: var(--bg-2); border-radius: 8px; }
        .level-name { color: var(--text-3); font-size: 12px; }
        .level-value { font-weight: 600; font-family: 'SF Mono', Monaco, monospace; }
        .risk-item { display: flex; align-items: center; gap: 12px; padding: 14px 16px; background: rgba(239, 68, 68, 0.08); border: 1px solid rgba(239, 68, 68, 0.2); border-radius: 8px; margin-bottom: 8px; }
        .risk-dot { width: 8px; height: 8px; background: var(--red); border-radius: 50%; flex-shrink: 0; }
        .test-row { display: grid; grid-template-columns: 120px 1fr 100px; gap: 16px; padding: 12px 16px; border-bottom: 1px solid var(--border); font-size: 13px; }
        .test-row:last-child { border-bottom: none; }
        .test-name { font-weight: 500; }
        .test-desc { color: var(--text-3); }
        .test-status { text-align: right; font-weight: 600; }
        .test-status.pass { color: var(--green); }
        .test-status.fail { color: var(--red); }
        .test-status.detected { color: var(--yellow); }
        .test-status.none { color: var(--text-3); }
        .vol-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid var(--border); font-size: 13px; }
        .vol-row:last-child { border-bottom: none; }
        .vol-name { color: var(--text-2); }
        .vol-value { font-weight: 500; font-family: 'SF Mono', Monaco, monospace; }
        .empty-state { padding: 24px; text-align: center; color: var(--text-3); font-style: italic; }
        .prov-table { width: 100%; }
        .prov-table tr { border-bottom: 1px solid var(--border); }
        .prov-table tr:last-child { border-bottom: none; }
        .prov-table td { padding: 12px 0; font-size: 13px; }
        .prov-table td:first-child { color: var(--text-3); width: 180px; }
        .prov-table td:last-child { font-family: 'SF Mono', Monaco, monospace; font-size: 12px; }
        .footer { text-align: center; padding: 32px; color: var(--text-3); font-size: 12px; }
        @media (max-width: 1200px) { .indicator-row { grid-template-columns: 1fr 1fr; } .grid-4 { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 768px) { .signal-hero { grid-template-columns: 1fr; } .grid-2 { grid-template-columns: 1fr; } .header { flex-direction: column; gap: 16px; } }
        @media print { body { background: white; color: black; } .section, .family-card, .signal-hero, .header { background: white; border-color: #ddd; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-left">
                <h1>MSFT</h1>
                <div class="company">Microsoft Corporation</div>
                <div class="header-meta">
                    <span>Technology</span>
                    <span>Software - Infrastructure</span>
                    <span>2015-01-01 to 2026-01-26</span>
                    <span>2,781 records</span>
                </div>
            </div>
            <div class="header-right">
                <div class="quality-badge">EXCELLENT</div>
                <div style="margin-top:8px;font-size:12px;color:var(--text-3)">
                    Generated 2026-01-26 23:24
                </div>
            </div>
        </div>
        
        <div class="signal-hero">
            <div class="signal-content">
                <div class="label">Overall Signal</div>
                <div class="value">SELL</div>
                <div class="strength">Strength: WEAK</div>
            </div>
            <svg viewBox="0 0 140 140" class="gauge">
        <circle cx="70" cy="70" r="54" fill="none" stroke="#1f2937" stroke-width="12"/>
        <circle cx="70" cy="70" r="54" fill="none" stroke="#f87171" stroke-width="12"
            stroke-dasharray="187.43012238128534 999" stroke-linecap="round" transform="rotate(-90 70 70)"/>
        <text x="70" y="65" class="gauge-value">55.2%</text>
        <text x="70" y="85" class="gauge-label">Confidence</text>
    </svg>
            <svg viewBox="0 0 140 140" class="gauge">
        <circle cx="70" cy="70" r="54" fill="none" stroke="#1f2937" stroke-width="12"/>
        <circle cx="70" cy="70" r="54" fill="none" stroke="#10b981" stroke-width="12"
            stroke-dasharray="333.83648403573 999" stroke-linecap="round" transform="rotate(-90 70 70)"/>
        <text x="70" y="65" class="gauge-value">98.4</text>
        <text x="70" y="85" class="gauge-label">Quality</text>
    </svg>
            <div class="recommendation">
                <div class="rec-label">Trading Recommendation</div>
                <div class="rec-text">NO TRADE: Weak or conflicting signals. Preserve capital and wait for better opportunity. (2 bearish divergence(s) confirm sell signal)</div>
            </div>
        </div>
        
        <div class="grid-2">
            <div class="section">
                <div class="section-title">Data Quality Assessment</div>
                <div class="grid-4">
                    <div class="metric"><div class="value">100.0</div><div class="label">Completeness</div></div>
                    <div class="metric"><div class="value">94.6</div><div class="label">Accuracy</div></div>
                    <div class="metric"><div class="value">100.0</div><div class="label">Consistency</div></div>
                    <div class="metric"><div class="value">100.0</div><div class="label">Timeliness</div></div>
                </div>
            </div>
            <div class="section">
                <div class="section-title">Market Profile</div>
                <div class="grid-4">
                    <div class="metric"><div class="value positive">+24.5%</div><div class="label">Annual Return</div></div>
                    <div class="metric"><div class="value">26.9%</div><div class="label">Volatility</div></div>
                    <div class="metric"><div class="value">0.76</div><div class="label">Sharpe</div></div>
                    <div class="metric"><div class="value">1.05</div><div class="label">Sortino</div></div>
                </div>
            </div>
        </div>
        
        <div class="section">
            <div class="section-title">Indicator Family Analysis</div>
            <div class="grid-2" style="margin-bottom:0">
            <div class="family-card">
                <div class="family-header">
                    <div class="family-badge" style="background:#6b7280">NEUTRAL</div>
                    <div class="family-meta">
                        <span class="family-name">MOMENTUM</span>
                        <span class="family-conf">50% confidence</span>
                    </div>
                    <div class="family-weight">25%</div>
                </div>
                <div class="indicators-list">
                <div class="indicator-row">
                    <span class="ind-name">RSI</span>
                    <span class="ind-signal" style="color:#6b7280">NEUTRAL</span>
                    <span class="ind-conf">50%</span>
                    <span class="ind-zone">NEUTRAL</span>
                    <span class="ind-factors">RSI neutral at 46.1; RSI momentum rising</span>
                </div>
                <div class="indicator-row">
                    <span class="ind-name">STOCHASTIC</span>
                    <span class="ind-signal" style="color:#6b7280">NEUTRAL</span>
                    <span class="ind-conf">50%</span>
                    <span class="ind-zone">NEUTRAL</span>
                    <span class="ind-factors">Stochastic neutral at 29.5</span>
                </div>
                <div class="indicator-row">
                    <span class="ind-name">WILLIAMS_R</span>
                    <span class="ind-signal" style="color:#6b7280">NEUTRAL</span>
                    <span class="ind-conf">50%</span>
                    <span class="ind-zone">NEUTRAL</span>
                    <span class="ind-factors">Williams %R neutral at -46.6</span>
                </div></div>
            </div>
            <div class="family-card">
                <div class="family-header">
                    <div class="family-badge" style="background:#6b7280">NEUTRAL</div>
                    <div class="family-meta">
                        <span class="family-name">TREND</span>
                        <span class="family-conf">58% confidence</span>
                    </div>
                    <div class="family-weight">25%</div>
                </div>
                <div class="indicators-list">
                <div class="indicator-row">
                    <span class="ind-name">MACD</span>
                    <span class="ind-signal" style="color:#f87171">SELL</span>
                    <span class="ind-conf">60%</span>
                    <span class="ind-zone">BEARISH</span>
                    <span class="ind-factors">Histogram contracting (bearish weakening); MACD below zero line</span>
                </div>
                <div class="indicator-row">
                    <span class="ind-name">ADX</span>
                    <span class="ind-signal" style="color:#6b7280">NEUTRAL</span>
                    <span class="ind-conf">40%</span>
                    <span class="ind-zone">WEAK_BEARISH</span>
                    <span class="ind-factors">Weak/no trend (ADX=25.5); -DI above +DI (bearish directional)</span>
                </div>
                <div class="indicator-row">
                    <span class="ind-name">SUPERTREND</span>
                    <span class="ind-signal" style="color:#34d399">BUY</span>
                    <span class="ind-conf">75%</span>
                    <span class="ind-zone">UPTREND</span>
                    <span class="ind-factors">Price 8.1% from Supertrend</span>
                </div></div>
            </div>
            <div class="family-card">
                <div class="family-header">
                    <div class="family-badge" style="background:#6b7280">NEUTRAL</div>
                    <div class="family-meta">
                        <span class="family-name">VOLATILITY</span>
                        <span class="family-conf">52% confidence</span>
                    </div>
                    <div class="family-weight">15%</div>
                </div>
                <div class="indicators-list">
                <div class="indicator-row">
                    <span class="ind-name">BOLLINGER</span>
                    <span class="ind-signal" style="color:#6b7280">NEUTRAL</span>
                    <span class="ind-conf">50%</span>
                    <span class="ind-zone">MIDDLE_LOWER</span>
                    <span class="ind-factors">Price in middle zone (%B=0.40); Volatility expanding</span>
                </div>
                <div class="indicator-row">
                    <span class="ind-name">KELTNER</span>
                    <span class="ind-signal" style="color:#f87171">SELL</span>
                    <span class="ind-conf">55%</span>
                    <span class="ind-zone">MIDDLE_LOWER</span>
                    <span class="ind-factors">Price below Keltner middle (bearish)</span>
                </div></div>
            </div>
            <div class="family-card">
                <div class="family-header">
                    <div class="family-badge" style="background:#f87171">SELL</div>
                    <div class="family-meta">
                        <span class="family-name">VOLUME</span>
                        <span class="family-conf">57% confidence</span>
                    </div>
                    <div class="family-weight">15%</div>
                </div>
                <div class="indicators-list">
                <div class="indicator-row">
                    <span class="ind-name">OBV</span>
                    <span class="ind-signal" style="color:#f87171">SELL</span>
                    <span class="ind-conf">65%</span>
                    <span class="ind-zone">DISTRIBUTION</span>
                    <span class="ind-factors">OBV below its 21-day MA (distribution)</span>
                </div>
                <div class="indicator-row">
                    <span class="ind-name">MFI</span>
                    <span class="ind-signal" style="color:#f87171">SELL</span>
                    <span class="ind-conf">55%</span>
                    <span class="ind-zone">BEARISH</span>
                    <span class="ind-factors">MFI bearish at 45.4</span>
                </div>
                <div class="indicator-row">
                    <span class="ind-name">CMF</span>
                    <span class="ind-signal" style="color:#6b7280">NEUTRAL</span>
                    <span class="ind-conf">50%</span>
                    <span class="ind-zone">NEUTRAL</span>
                    <span class="ind-factors">Neutral money flow (CMF=0.003)</span>
                </div></div>
            </div>
            <div class="family-card">
                <div class="family-header">
                    <div class="family-badge" style="background:#ef4444">STRONG SELL</div>
                    <div class="family-meta">
                        <span class="family-name">SYSTEM</span>
                        <span class="family-conf">90% confidence</span>
                    </div>
                    <div class="family-weight">20%</div>
                </div>
                <div class="indicators-list">
                <div class="indicator-row">
                    <span class="ind-name">ICHIMOKU</span>
                    <span class="ind-signal" style="color:#ef4444">STRONG SELL</span>
                    <span class="ind-conf">90%</span>
                    <span class="ind-zone">STRONG_BEARISH</span>
                    <span class="ind-factors">Price below cloud; Cloud is bearish</span>
                </div></div>
            </div></div>
        </div>
        
        <div class="grid-2">
            <div class="section">
                <div class="section-title">Key Technical Levels</div>
                <div class="grid-4">
                <div class="level-item">
                    <span class="level-name">BB Upper</span>
                    <span class="level-value">$503.13</span>
                </div>
                <div class="level-item">
                    <span class="level-name">BB Middle</span>
                    <span class="level-value">$471.93</span>
                </div>
                <div class="level-item">
                    <span class="level-name">BB Lower</span>
                    <span class="level-value">$440.72</span>
                </div>
                <div class="level-item">
                    <span class="level-name">KC Upper</span>
                    <span class="level-value">$488.64</span>
                </div>
                <div class="level-item">
                    <span class="level-name">KC Lower</span>
                    <span class="level-value">$447.77</span>
                </div>
                <div class="level-item">
                    <span class="level-name">Supertrend</span>
                    <span class="level-value">$428.28</span>
                </div>
                <div class="level-item">
                    <span class="level-name">Cloud Top</span>
                    <span class="level-value">$509.30</span>
                </div>
                <div class="level-item">
                    <span class="level-name">Cloud Bottom</span>
                    <span class="level-value">$485.80</span>
                </div></div>
            </div>
            <div class="section">
                <div class="section-title">Detected Divergences</div>
                
                <div class="divergence-item" style="border-color:#ef4444">
                    <span class="div-type" style="color:#ef4444">HIDDEN BEARISH</span>
                    <span class="div-ind">RSI</span>
                    <span class="div-strength">4%</span>
                    <span class="div-duration">15 bars</span>
                </div>
                <div class="divergence-item" style="border-color:#ef4444">
                    <span class="div-type" style="color:#ef4444">HIDDEN BEARISH</span>
                    <span class="div-ind">MACD</span>
                    <span class="div-strength">31%</span>
                    <span class="div-duration">15 bars</span>
                </div>
            </div>
        </div>
        
        <div class="grid-2">
            <div class="section">
                <div class="section-title">Statistical Tests</div>
                
            <div class="test-row">
                <span class="test-name">Jarque-Bera</span>
                <span class="test-desc">Normality</span>
                <span class="test-status fail">FAIL</span>
            </div>
            <div class="test-row">
                <span class="test-name">ADF</span>
                <span class="test-desc">Stationarity</span>
                <span class="test-status pass">PASS</span>
            </div>
            <div class="test-row">
                <span class="test-name">KPSS</span>
                <span class="test-desc">Trend Stationary</span>
                <span class="test-status pass">PASS</span>
            </div>
            <div class="test-row">
                <span class="test-name">Ljung-Box</span>
                <span class="test-desc">Autocorrelation</span>
                <span class="test-status detected">DETECTED</span>
            </div>
            <div class="test-row">
                <span class="test-name">ARCH</span>
                <span class="test-desc">Vol Clustering</span>
                <span class="test-status detected">DETECTED</span>
            </div>
            </div>
            <div class="section">
                <div class="section-title">Volatility Estimators (7)</div>
                
                <div class="vol-row">
                    <span class="vol-name">Close to Close</span>
                    <span class="vol-value">21.69%</span>
                </div>
                <div class="vol-row">
                    <span class="vol-name">Parkinson</span>
                    <span class="vol-value">18.80%</span>
                </div>
                <div class="vol-row">
                    <span class="vol-name">Garman-Klass</span>
                    <span class="vol-value">18.67%</span>
                </div>
                <div class="vol-row">
                    <span class="vol-name">Rogers-Satchell</span>
                    <span class="vol-value">18.43%</span>
                </div>
                <div class="vol-row">
                    <span class="vol-name">Yang-Zhang</span>
                    <span class="vol-value">12.85%</span>
                </div>
                <div class="vol-row">
                    <span class="vol-name">GKYZ</span>
                    <span class="vol-value">21.17%</span>
                </div>
                <div class="vol-row">
                    <span class="vol-name">Hodges-Tompkins</span>
                    <span class="vol-value">22.61%</span>
                </div>
                <div class="vol-row">
                    <span class="vol-name">Composite</span>
                    <span class="vol-value">18.73%</span>
                </div>
            </div>
        </div>
        
        <div class="section">
            <div class="section-title">Risk Factors</div>
            <div class="empty-state">No significant risk factors</div>
        </div>
        
        <div class="section">
            <div class="section-title">Data Provenance</div>
            <table class="prov-table">
                <tr><td>Data Source</td><td>yahoo_finance</td></tr>
                <tr><td>Fetch Timestamp</td><td>2026-01-26T23:22:00.164920</td></tr>
                <tr><td>Data Hash (SHA-256)</td><td>48660e8eb1437ee8</td></tr>
                <tr><td>Records</td><td>2,781 daily | 578 weekly | 133 monthly</td></tr>
                <tr><td>Engine Version</td><td>2.0.0</td></tr>
            </table>
        </div>
        
        <div class="footer">
            <strong>Quantitative Technical Analysis Agent v1.0.0</strong><br>
            MSc AI Agents in Asset Management - Track B<br>
            Report generated 2026-01-26 23:24:44
        </div>
    </div>
</body>
</html>